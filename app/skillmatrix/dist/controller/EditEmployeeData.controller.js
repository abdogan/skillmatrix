sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/UIComponent","skillmatrix/skillmatrix/formatter/EditEmployeeDataFormatter"],function(e,t,s){"use strict";return e.extend("skillmatrix.skillmatrix.controller.EditEmployeeData",{formatter:s,onInit(){const e=t.getRouterFor(this);e.getRoute("RouteEditEmployeeData").attachPatternMatched(this._onEmployeeMatched,this)},getText(e,t){return this.getView().getModel("i18n").getResourceBundle().getText(e,t)},_onEmployeeMatched(e){const t=e.getParameter("arguments").KID;this.getView().bindElement({path:"/TeamMembers('"+t+"')",model:"catalogModel",parameters:{$$updateGroupId:"teamMembersGroup"}})},onAddSkill(){const e=this.byId("skillsComboBox"),t=this.byId("expertiseLevelComboBox"),s=e.getSelectedKey(),a=t.getSelectedKey(),o=this.getView().getBindingContext("catalogModel").getProperty("KID");if(!s||!a){sap.m.MessageToast.show(this.getText("selectSkillAndLevel"));return}const i=this.byId("skillsTable"),l=i.getBinding("rows"),r=l.getContexts();for(let e=0;e<r.length;e++){let t=r[e].getProperty("SKILL");if(t===s){sap.m.MessageToast.show(this.getText("duplicateSkill"));return}}const n={KID:o,SKILL:s,SCORE:a};const g=l.create(n);e.setSelectedKey("");t.setSelectedKey("")},onDeleteSkill(e){const t=e.getSource(),s=t.getBindingContext("catalogModel");s["delete"]("$auto").then(function(){sap.m.MessageToast.show(this.getText("skillRemoved"))}).catch(function(e){sap.m.MessageToast.show(this.getText("skillRemoveError")+e.message)})},handleCancel(){this.getView().getModel("catalogModel").resetChanges("teamMembersGroup");const e=t.getRouterFor(this);e.navTo("RouteMain",{},true)},_validateForm(){const e=this.getView();let t=true;const s=e.byId("FirstName"),a=e.byId("LastName"),o=e.byId("Email");const i=s.getValue(),l=a.getValue(),r=o.getValue();const n=/^[A-Za-zÀ-ÿ'-]+$/,g=/^\S+@\S+\.\S+$/;if(!i){s.setValueState("Error");s.setValueStateText(this.getText("fieldRequiredText"));t=false}else if(!n.test(i)){s.setValueState("Error");s.setValueStateText(this.getText("nameInputValueStateText"));t=false}else{s.setValueState("None")}if(!l){a.setValueState("Error");a.setValueStateText(this.getText("fieldRequiredText"));t=false}else if(!n.test(l)){a.setValueState("Error");a.setValueStateText(this.getText("nameInputValueStateText"));t=false}else{a.setValueState("None")}if(!r){o.setValueState("Error");o.setValueStateText(this.getText("fieldRequiredText"));t=false}else if(!g.test(r)){o.setValueState("Error");o.setValueStateText(this.getText("emailInputValueStateText"));t=false}else{o.setValueState("None")}return t},handleSubmit(){if(!this._validateForm()){sap.m.MessageBox.warning(this.getText("errorOnSubmitWarning"));return}sap.m.MessageBox.confirm(this.getText("confirmSubmitMessage"),{title:this.getText("confirmSubmitTitle"),actions:[sap.m.MessageBox.Action.OK,sap.m.MessageBox.Action.CANCEL],onClose:e=>{if(e===sap.m.MessageBox.Action.OK){this.getView().getModel("catalogModel").submitBatch("teamMembersGroup").then(()=>{sap.m.MessageToast.show(this.getText("editDataSuccess"));const e=t.getRouterFor(this);setTimeout(()=>{e.navTo("RouteMain",{},true)},500)}).catch(e=>{sap.m.MessageBox.error(this.getText("errorOnSubmitMessage"));console.error(this.getText("submitFailed"),e)})}else{return}}})}})});
//# sourceMappingURL=EditEmployeeData.controller.js.map